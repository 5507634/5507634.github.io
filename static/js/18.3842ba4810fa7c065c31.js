webpackJsonp([18],{UrOs:function(n,t,e){var i=e("mU0H");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);var r=e("rjj0").default;r("401c1978",i,!0,{})},cNJb:function(n,t,e){n.exports=e.p+"static/img/insert_keycard.cd93e88.gif"},mU0H:function(n,t,e){t=n.exports=e("FZ+f")(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},pyRw:function(n,t,e){"use strict";function i(n){e("UrOs")}Object.defineProperty(t,"__esModule",{value:!0});var r=e("NYxO"),a=e("cNJb"),c=e.n(a),s={computed:Object(r.b)({device:function(n){return n.keycard}}),data:function(){return{loading:!1,timer:null,img_insert_keycard:c.a}},methods:{startDevice:function(){var n=this;this.loading=!0,this.$store.dispatch("KeycardOpen").then(function(){n.loading=!1,n.timer=setInterval(function(){n.queryDevice()},1e3)}).catch(function(){n.loading=!1})},closeDevice:function(){null!=this.timer&&(clearInterval(this.timer),this.timer=null,this.$store.dispatch("KeycardClose").then(function(){}).catch(function(){}))},queryDevice:function(){var n=this;this.$store.dispatch("KeycardRead").then(function(){console.log(new Date,n.device.id),n.handleKeycard()}).catch(function(){})},handleKeycard:function(){var n=this;this.loading=!0,this.$store.dispatch("GetOrderByKeycard",this.device.id).then(function(){n.loading=!1,""===n.$store.state.order.id?n.$message({message:"没有该房卡对应订单信息，请重新插入正确的房卡!",type:"warning",duration:5e3}):n.$router.push({name:"extension/extend"})}).catch(function(){n.loading=!1})},simulateKeycard:function(){this.closeDevice(),this.startDevice()}},mounted:function(){},beforeDestroy:function(){this.closeDevice()}},o=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"container"},[e("el-row",{attrs:{type:"flex",justify:"center"}},[e("span",{staticClass:"txt_title"},[n._v("请插入房卡")])]),n._v(" "),e("el-row",{attrs:{type:"flex",justify:"center"}},[e("img",{attrs:{src:n.img_insert_keycard,alt:"insert_keycard"}})]),n._v(" "),e("el-row",{attrs:{type:"flex",justify:"center"}},[e("el-col",{attrs:{span:16}},[e("el-button",{staticClass:"btn_large",attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),n.simulateKeycard(t)}}},[n._v("模拟插卡")])],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("router-link",{attrs:{to:{name:"home"}}},[e("el-button",{staticClass:"btn_large",attrs:{type:"primary"}},[n._v("返回")])],1)],1)],1)],1)},l=[],u=e("XyMi"),d=i,f=Object(u.a)(s,o,l,!1,d,"data-v-56f278a6",null);t.default=f.exports}});